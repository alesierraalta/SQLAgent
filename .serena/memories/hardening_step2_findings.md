Actualizado: validador con sqlglot (single statement, sin comentarios/;), comandos peligrosos ampliados, funciones whitelisted, CTE/subqueries recursivas, alias en ORDER BY ignorados. Engine con statement_timeout y default_transaction_read_only. Tests de seguridad añadidos (multi-statement, comentarios, DML, CTE inválida). Cobertura ajustada a scope crítico (validators/db) con >80%.